<!doctype html>
<html lang="en" dir="ltr" class="mdx-wrapper mdx-page plugin-pages plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="vegas-credentials RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="vegas-credentials Atom Feed"><title data-rh="true">Design Principles | vegas-credentials</title><meta data-rh="true" property="og:url" content="https://credentials.vegas/design-principles"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="twitter:description" content="AWS credential_process utility to request STS Temporary Security Credentials by assuming an IAM role with TOTP MFA via either Yubikey Touch or Authenticator Apps."><meta data-rh="true" itemprop="description" content="AWS credential_process utility to request STS Temporary Security Credentials by assuming an IAM role with TOTP MFA via either Yubikey Touch or Authenticator Apps."><meta data-rh="true" name="keywords" content="amazon web services, aws, iam, sts, mfa, multi-factor authentication, yubikey"><meta data-rh="true" name="twitter:title" content="vegas-credentials"><meta data-rh="true" itemprop="title" content="vegas-credentials"><meta data-rh="true" property="og:image" content="https://credentials.vegas/img/vegas-credentials-hero.jpg"><meta data-rh="true" name="twitter:image" content="https://credentials.vegas/img/vegas-credentials-hero.jpg"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" itemprop="image" content="https://credentials.vegas/img/vegas-credentials-hero.jpg"><meta data-rh="true" property="og:title" content="Design Principles | vegas-credentials"><meta data-rh="true" name="description" content="Out of Scope Features"><meta data-rh="true" property="og:description" content="Out of Scope Features"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://credentials.vegas/design-principles"><link data-rh="true" rel="alternate" href="https://credentials.vegas/design-principles" hreflang="en"><link data-rh="true" rel="alternate" href="https://credentials.vegas/design-principles" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d95f9b15.css">
<link rel="preload" href="/assets/js/runtime~main.63819f17.js" as="script">
<link rel="preload" href="/assets/js/main.ffe3b1a9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title">Vegas Credentials</b></a><a class="navbar__item navbar__link" href="/docs/setup">Docs</a><a class="navbar__item navbar__link" href="/design-principles">Design Principles</a><a class="navbar__item navbar__link" href="/alternatives">Alternatives</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/aripalo/vegas-credentials" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><main class="container container--fluid margin-vert--lg"><div class="row mdxPageWrapper_zHyg"><div class="col col--8"><h1>Design Principles</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="out-of-scope-features">Out of Scope Features<a class="hash-link" href="#out-of-scope-features" title="Direct link to heading">​</a></h2><p><em>By design</em>, some features are not implemented by <code>vegas-credentials</code> to either avoid feature bloat and also to shift responsibility to more suitable tools.</p><p>In essence, this tool <strong>DOES NOT support</strong>:</p><ol><li><p>AWS SSO:</p><p>→ See <a href="https://github.com/benkehoe/aws-sso-util" target="_blank" rel="noopener noreferrer"><code>benkehoe/aws-sso-util</code></a> for that</p></li><li><p>Encrypting of master/source (long-term user) credentials in <code>~/.aws/credentials</code></p><p>→ You may implement this quite easily <a href="https://www.youtube.com/watch?v=W8IyScUGuGI&amp;t=1260s" target="_blank" rel="noopener noreferrer">with few lines of bash &amp; <code>credential_process</code></a></p><p>→ … or use a tool such as <a href="https://github.com/99designs/aws-vault" target="_blank" rel="noopener noreferrer"><code>99designs/aws-vault</code></a></p></li><li><p>SAML or OpenID Connect federated authentication</p></li><li><p>Acting as a credential source in EC2 – i.e. <code>vegas-credentials</code> is meant for local development usage</p></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="your-code--workflow-must-not-require-customization">Your Code &amp; Workflow MUST NOT Require Customization<a class="hash-link" href="#your-code--workflow-must-not-require-customization" title="Direct link to heading">​</a></h2><p>Having to modify your source code or having to run custom commands before executing your AWS tools is infuriating but many existing solutions require one of the following either executing a custom script beforehand, wrapping your command somehow and/or modifying your code.</p><p>Instead <code>vegas-credentials</code> works with AWS <code>credential_process</code> which is exactly aimed for sourcing credentials via external processes <em>in the background</em> without needing any customization in your code or workflow. Only thing that is required is a bit of configuration in your <code>~/.aws/config</code>.</p><p>If your unfamiliar with <code>credential_process</code>, <a href="https://www.youtube.com/watch?v=W8IyScUGuGI&amp;t=1260s" target="_blank" rel="noopener noreferrer">this AWS re:Invent video</a> explains it very well.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dont-export-anything-to-environment">Don&#x27;t export anything to environment<a class="hash-link" href="#dont-export-anything-to-environment" title="Direct link to heading">​</a></h2><p>AWS credentials are kept out of the environment due to the usage of credential sourcing in the background via <code>credential_process</code> (see above).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="never-read-awscredentials">Never read <code>~/.aws/credentials</code><a class="hash-link" href="#never-read-awscredentials" title="Direct link to heading">​</a></h2><p>By design <code>vegas-credential</code> command itself never reads/parses <code>~/.aws/credentials</code> file which can contain sensitive long-term credentials: It only parses the <code>~/.aws/config</code> and then delegates the authentication process to AWS Go SDK by telling it <em>assume this role using this profile name</em>, after which the AWS Go SDK will lookup the long-term credentials for that given profile name.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="cache-mechanism">Cache Mechanism<a class="hash-link" href="#cache-mechanism" title="Direct link to heading">​</a></h2><p>This tool caches temporary session credentials to disk. In the background it uses <a href="https://github.com/dgraph-io/badger/" target="_blank" rel="noopener noreferrer"><code>dgraph-io/badger</code></a> which is a fast SSD-optimized key-value store for Go and importantly supports Time-to-Live attributes for data (useful for temporary session credential expiration).</p><p>The data is stored into the key-value store with <code>AES-256-CTR</code> encryption. The encryption secret is derived from the environment (system boot time, hostname and user UID). So this is not a 100% secure setup, but it&#x27;s slightly “better” compared to what <a href="https://github.com/broamski/aws-mfa" target="_blank" rel="noopener noreferrer"><code>broamski/aws-mfa</code></a> does or how AWS CLI caches to <code>~/.aws/cli/cache</code>: At least it provides “security by obscurity” solution against rogue scripts that might try to steal your credentials. And then again, it&#x27;s only caching <strong><em>temporary</em></strong> session credentials – which you should aim to keep short-lived!</p><p>Reason why it caches temporary session credentials in the first place is to create a better user experience with AWS tools that don&#x27;t support temporary session credential caching with assumed roles.</p><p>By default, the cached data is invalidated if the environment changes (system boot time, hostname and user UID), but this is okay since this tool will then query STS for new temporary session credentials and add them to cache.</p><p>Also this tool invalidates cached credentials if their expiration time is within 10 minutes and retrieves new ones. This functionality matches to <a href="https://github.com/boto/botocore/blob/221ffa67a567df99ee78d7ae308c0e12d7eeeea7/botocore/credentials.py#L350-L355" target="_blank" rel="noopener noreferrer"><code>botocore</code></a>.</p></div><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#out-of-scope-features" class="table-of-contents__link toc-highlight">Out of Scope Features</a></li><li><a href="#your-code--workflow-must-not-require-customization" class="table-of-contents__link toc-highlight">Your Code &amp; Workflow MUST NOT Require Customization</a></li><li><a href="#dont-export-anything-to-environment" class="table-of-contents__link toc-highlight">Don&#39;t export anything to environment</a></li><li><a href="#never-read-awscredentials" class="table-of-contents__link toc-highlight">Never read <code>~/.aws/credentials</code></a></li><li><a href="#cache-mechanism" class="table-of-contents__link toc-highlight">Cache Mechanism</a></li></ul></div></div></div></main></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/setup">Setup</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/vegas-credentials" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/aripalo/vegas-credentials/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/aripalo/vegas-credentials/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/aripalo/vegas-credentials" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aripalo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Author<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Ari Palo. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.63819f17.js"></script>
<script src="/assets/js/main.ffe3b1a9.js"></script>
</body>
</html>